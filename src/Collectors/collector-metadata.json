{
  "collectors": [
    {
      "name": "Get-ServerInfo",
      "displayName": "Server Information",
      "description": "Collects OS, hardware, network, and system information",
      "filename": "Get-ServerInfo.ps1",
      "category": "core",
      "psVersions": ["2.0", "4.0", "5.1", "7.0"],
      "minWindowsVersion": "2008R2",
      "maxWindowsVersion": null,
      "dependencies": [],
      "timeout": 30,
      "estimatedExecutionTime": 10,
      "criticalForMigration": true,
      "variants": {
        "2.0": "Get-ServerInfo.ps1",
        "4.0": "Get-ServerInfo.ps1",
        "5.1": "Get-ServerInfo-PS5.ps1",
        "7.0": "Get-ServerInfo-PS7.ps1"
      }
    },
    {
      "name": "Get-ADInfo",
      "displayName": "Active Directory Information",
      "description": "Collects AD membership, group policy, and domain information",
      "filename": "Get-ADInfo.ps1",
      "category": "infrastructure",
      "psVersions": ["2.0", "4.0", "5.1"],
      "minWindowsVersion": "2008R2",
      "maxWindowsVersion": null,
      "dependencies": ["RSAT-AD-PowerShell"],
      "timeout": 45,
      "estimatedExecutionTime": 20,
      "criticalForMigration": true,
      "variants": {
        "2.0": "Get-ADInfo.ps1",
        "4.0": "Get-ADInfo.ps1",
        "5.1": "Get-ADInfo-PS5.ps1"
      }
    },
    {
      "name": "Get-IISInfo",
      "displayName": "IIS Configuration",
      "description": "Collects IIS versions, bindings, application pools, and SSL certificates",
      "filename": "Get-IISInfo.ps1",
      "category": "application",
      "psVersions": ["2.0", "4.0", "5.1", "7.0"],
      "minWindowsVersion": "2008R2",
      "maxWindowsVersion": null,
      "dependencies": ["WebAdministration"],
      "timeout": 60,
      "estimatedExecutionTime": 25,
      "criticalForMigration": false,
      "variants": {
        "2.0": "Get-IISInfo.ps1",
        "4.0": "Get-IISInfo.ps1",
        "5.1": "Get-IISInfo-PS5.ps1",
        "7.0": "Get-IISInfo-PS7.ps1"
      }
    },
    {
      "name": "Get-SQLServerInfo",
      "displayName": "SQL Server Configuration",
      "description": "Collects SQL Server instances, versions, databases, and configuration",
      "filename": "Get-SQLServerInfo.ps1",
      "category": "application",
      "psVersions": ["2.0", "4.0", "5.1"],
      "minWindowsVersion": "2008R2",
      "maxWindowsVersion": null,
      "dependencies": ["SQL-Server-Management-Studio", "SQL-Server-PowerShell"],
      "timeout": 90,
      "estimatedExecutionTime": 40,
      "criticalForMigration": true,
      "variants": {
        "2.0": "Get-SQLServerInfo.ps1",
        "4.0": "Get-SQLServerInfo.ps1",
        "5.1": "Get-SQLServerInfo-PS5.ps1"
      }
    },
    {
      "name": "Get-HyperVInfo",
      "displayName": "Hyper-V Configuration",
      "description": "Collects Hyper-V host settings and virtual machine inventory",
      "filename": "Get-HyperVInfo.ps1",
      "category": "infrastructure",
      "psVersions": ["4.0", "5.1", "7.0"],
      "minWindowsVersion": "2012R2",
      "maxWindowsVersion": null,
      "dependencies": ["Hyper-V-PowerShell"],
      "timeout": 60,
      "estimatedExecutionTime": 30,
      "criticalForMigration": false,
      "variants": {
        "4.0": "Get-HyperVInfo.ps1",
        "5.1": "Get-HyperVInfo-PS5.ps1",
        "7.0": "Get-HyperVInfo-PS7.ps1"
      }
    },
    {
      "name": "Get-Services",
      "displayName": "Windows Services",
      "description": "Collects running and installed Windows services with startup types",
      "filename": "Get-Services.ps1",
      "category": "core",
      "psVersions": ["2.0", "4.0", "5.1", "7.0"],
      "minWindowsVersion": "2008R2",
      "maxWindowsVersion": null,
      "dependencies": [],
      "timeout": 30,
      "estimatedExecutionTime": 10,
      "criticalForMigration": false,
      "variants": {
        "2.0": "Get-Services.ps1",
        "4.0": "Get-Services.ps1",
        "5.1": "Get-Services-PS5.ps1",
        "7.0": "Get-Services-PS7.ps1"
      }
    },
    {
      "name": "Get-InstalledApps",
      "displayName": "Installed Applications",
      "description": "Collects installed software from Windows registry and WMI",
      "filename": "Get-InstalledApps.ps1",
      "category": "core",
      "psVersions": ["2.0", "4.0", "5.1", "7.0"],
      "minWindowsVersion": "2008R2",
      "maxWindowsVersion": null,
      "dependencies": [],
      "timeout": 45,
      "estimatedExecutionTime": 20,
      "criticalForMigration": true,
      "variants": {
        "2.0": "Get-InstalledApps.ps1",
        "4.0": "Get-InstalledApps.ps1",
        "5.1": "Get-InstalledApps-PS5.ps1",
        "7.0": "Get-InstalledApps-PS7.ps1"
      }
    },
    {
      "name": "Get-ServerRoles",
      "displayName": "Server Roles and Features",
      "description": "Collects Windows Server roles, features, and component inventory",
      "filename": "Get-ServerRoles.ps1",
      "category": "core",
      "psVersions": ["2.0", "4.0", "5.1", "7.0"],
      "minWindowsVersion": "2008R2",
      "maxWindowsVersion": null,
      "dependencies": [],
      "timeout": 30,
      "estimatedExecutionTime": 15,
      "criticalForMigration": true,
      "priority": "TIER1"
    },
    {
      "name": "Get-ShareInfo",
      "displayName": "File Shares and Permissions",
      "description": "Collects file share paths, permissions, sizes, and access control",
      "filename": "Get-ShareInfo.ps1",
      "category": "infrastructure",
      "psVersions": ["2.0", "4.0", "5.1", "7.0"],
      "minWindowsVersion": "2008R2",
      "maxWindowsVersion": null,
      "dependencies": [],
      "timeout": 60,
      "estimatedExecutionTime": 30,
      "criticalForMigration": true,
      "priority": "TIER2"
    },
    {
      "name": "Get-LocalAccounts",
      "displayName": "Local User and Group Accounts",
      "description": "Collects local user accounts, group memberships, and privilege levels",
      "filename": "Get-LocalAccounts.ps1",
      "category": "infrastructure",
      "psVersions": ["2.0", "4.0", "5.1", "7.0"],
      "minWindowsVersion": "2008R2",
      "maxWindowsVersion": null,
      "dependencies": [],
      "timeout": 30,
      "estimatedExecutionTime": 15,
      "criticalForMigration": true,
      "priority": "TIER2"
    },
    {
      "name": "Get-ExchangeInfo",
      "displayName": "Exchange Server Configuration",
      "description": "Collects Exchange Server version, connectors, and database configuration",
      "filename": "Get-ExchangeInfo.ps1",
      "category": "application",
      "psVersions": ["2.0", "4.0", "5.1", "7.0"],
      "minWindowsVersion": "2008R2",
      "maxWindowsVersion": null,
      "dependencies": ["Exchange-Server"],
      "timeout": 90,
      "estimatedExecutionTime": 45,
      "criticalForMigration": false,
      "priority": "TIER3"
    },
    {
      "name": "Data-Discovery-PII",
      "displayName": "PII Data Discovery",
      "description": "Scans file systems for personally identifiable information (SSN, credit cards, email)",
      "filename": "Data-Discovery-PII.ps1",
      "category": "compliance",
      "psVersions": ["2.0", "4.0", "5.1", "7.0"],
      "minWindowsVersion": "2008R2",
      "maxWindowsVersion": null,
      "dependencies": [],
      "timeout": 300,
      "estimatedExecutionTime": 120,
      "criticalForMigration": true,
      "priority": "TIER4"
    },
    {
      "name": "Data-Discovery-FinancialUK",
      "displayName": "UK Financial Data Discovery",
      "description": "Scans for UK-specific financial data (IBAN, sort codes, National Insurance numbers)",
      "filename": "Data-Discovery-FinancialUK.ps1",
      "category": "compliance",
      "psVersions": ["2.0", "4.0", "5.1", "7.0"],
      "minWindowsVersion": "2008R2",
      "maxWindowsVersion": null,
      "dependencies": [],
      "timeout": 300,
      "estimatedExecutionTime": 120,
      "criticalForMigration": true,
      "priority": "TIER4"
    },
    {
      "name": "Data-Discovery-HeatMap",
      "displayName": "Data Heat Map (Hot/Warm/Cool)",
      "description": "Classifies data by modification date (HOT <30d, WARM 30-180d, COOL >180d)",
      "filename": "Data-Discovery-HeatMap.ps1",
      "category": "compliance",
      "psVersions": ["2.0", "4.0", "5.1", "7.0"],
      "minWindowsVersion": "2008R2",
      "maxWindowsVersion": null,
      "dependencies": [],
      "timeout": 300,
      "estimatedExecutionTime": 180,
      "criticalForMigration": true,
      "priority": "TIER4"
    },
    {
      "name": "Get-ScheduledTasks",
      "displayName": "Scheduled Tasks and Jobs",
      "description": "Collects scheduled tasks, backup jobs, maintenance triggers, and execution history",
      "filename": "Get-ScheduledTasks.ps1",
      "category": "infrastructure",
      "psVersions": ["2.0", "4.0", "5.1", "7.0"],
      "minWindowsVersion": "2008R2",
      "maxWindowsVersion": null,
      "dependencies": [],
      "timeout": 60,
      "estimatedExecutionTime": 30,
      "criticalForMigration": true,
      "priority": "TIER5"
    },
    {
      "name": "Get-CertificateInfo",
      "displayName": "SSL/TLS Certificate Inventory",
      "description": "Collects SSL/TLS certificates, expiry dates, issuer, and validity information",
      "filename": "Get-CertificateInfo.ps1",
      "category": "compliance",
      "psVersions": ["2.0", "4.0", "5.1", "7.0"],
      "minWindowsVersion": "2008R2",
      "maxWindowsVersion": null,
      "dependencies": [],
      "timeout": 30,
      "estimatedExecutionTime": 15,
      "criticalForMigration": true,
      "priority": "TIER5"
    }
  ],
  "categorizedCollectors": {
    "core": [
      "Get-ServerInfo",
      "Get-Services",
      "Get-InstalledApps",
      "Get-ServerRoles"
    ],
    "infrastructure": [
      "Get-ADInfo",
      "Get-DNSInfo",
      "Get-DHCPInfo",
      "Get-HyperVInfo",
      "Get-ShareInfo",
      "Get-LocalAccounts",
      "Get-ScheduledTasks"
    ],
    "application": [
      "Get-IISInfo",
      "Get-SQLServerInfo",
      "Get-ExchangeInfo",
      "Get-SharePointInfo"
    ],
    "compliance": [
      "Data-Discovery-PII",
      "Data-Discovery-FinancialUK",
      "Data-Discovery-HeatMap",
      "Get-CertificateInfo"
    ]
  },
  "schema": {
    "version": "2.0",
    "lastModified": "2025-11-21",
    "description": "Collector metadata schema for ServerAuditToolkitV2. Enables version-aware, performance-optimized collector selection with execution timing and timeout management.",
    "fields": {
      "name": "Unique collector identifier (used in Invoke-ServerAudit -Collectors parameter)",
      "displayName": "Human-readable collector name for reports",
      "description": "Brief description of what this collector discovers",
      "filename": "Primary filename for this collector (base variant)",
      "category": "Classification: core, infrastructure, application, or compliance",
      "psVersions": "Array of PowerShell versions that support this collector",
      "minWindowsVersion": "Minimum Windows Server version required (e.g., 2008R2, 2012R2, 2016)",
      "maxWindowsVersion": "Maximum Windows Server version (null = no upper limit)",
      "dependencies": "Required Windows features or modules (RSAT, WebAdministration, etc.)",
      "timeout": "Max execution time in seconds for this collector",
      "estimatedExecutionTime": "Typical execution time in seconds (for planning)",
      "criticalForMigration": "Whether data from this collector is essential for migration decisions",
      "variants": "Optimized implementations for specific PowerShell versions (e.g., PS5, PS7)"
    }
  },
  "executionNotes": {
    "maxConcurrentServers": 3,
    "maxConcurrentCollectors": 2,
    "businessHoursCutoff": "Stop execution 1 hour before 8:00 AM (configurable in audit-config.json)",
    "timeoutBehavior": "Collectors exceeding timeout are stopped gracefully; audit continues with remaining collectors",
    "errorHandling": "Failed collectors are logged but do not halt execution (continueOnError: true)"
  }
}